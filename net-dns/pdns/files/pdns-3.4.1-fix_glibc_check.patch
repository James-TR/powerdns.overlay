From 1a61508c53512e9d28332d6e450314a515360737 Mon Sep 17 00:00:00 2001
From: James Taylor <james@jtaylor.id.au>
Date: Wed, 17 Dec 2014 08:14:34 +0000
Subject: [PATCH 1/2] Change ifdef to check for __GLIBC__ instead of __linux__
 to prevent errors with other libc's

---
 pdns/receiver.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pdns/receiver.cc b/pdns/receiver.cc
index c8f3341..eb82ff8 100644
--- a/pdns/receiver.cc
+++ b/pdns/receiver.cc
@@ -373,7 +373,7 @@ static void loadModules()
   }
 }
 
-#ifdef __linux__
+#ifdef __GLIBC__
 #include <execinfo.h>
 static void tbhandler(int num)
 {

From 2005fe2ed6c20bf221433cbaa68364154620e1dd Mon Sep 17 00:00:00 2001
From: James Taylor <james@jtaylor.id.au>
Date: Wed, 17 Dec 2014 08:59:19 +0000
Subject: [PATCH 2/2] Missed some traceback handler ifdefs

---
 pdns/receiver.cc | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/pdns/receiver.cc b/pdns/receiver.cc
index eb82ff8..763ca8f 100644
--- a/pdns/receiver.cc
+++ b/pdns/receiver.cc
@@ -405,7 +405,7 @@ int main(int argc, char **argv)
   s_programname="pdns";
   s_starttime=time(0);
 
-#ifdef __linux__
+#ifdef __GLIBC__
   signal(SIGSEGV,tbhandler);
   signal(SIGFPE,tbhandler);
   signal(SIGABRT,tbhandler);
@@ -470,7 +470,7 @@ int main(int argc, char **argv)
     
     // we really need to do work - either standalone or as an instance
 
-#ifdef __linux__
+#ifdef __GLIBC__
     if(!::arg().mustDo("traceback-handler")) {
       L<<Logger::Warning<<"Disabling traceback handler"<<endl;
       signal(SIGSEGV,SIG_DFL);
